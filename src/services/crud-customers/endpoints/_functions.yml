#function para cadastro de customer
createCustomer:
  warmup: true
  handler: src/services/crud-customers/endpoints/createCustomer.handler
  environment:
    SNS_TOPIC_CUSTOMER_CREATE:
      Fn::ImportValue: ${self:custom.stage}:${self:service}-infra:customersCreateEventsTopicArn
  iamRoleStatements:
    - Effect: "Allow"
      Resource:
        Fn::ImportValue: ${self:custom.stage}:${self:service}-infra:customersCreateEventsTopicArn
      Action:
        - sns:Publish
  events:
    - http:
        path: /customers
        method: post
        cors: true

#function para a listagem de customers
findCustomers:
  warmup: true
  handler: src/services/crud-customers/endpoints/findCustomers.handler
  events:
    - http:
        path: /customers
        method: get
        cors: true

#function para a bsca de um unico customer
findOneCustomer:
  warmup: true
  handler: src/services/crud-customers/endpoints/findOneCustomer.handler
  events:
    - http:
        path: /customers/{id}
        method: get
        cors: true

#function para atulaizar customer
updateCustomer:
  warmup: true
  handler: src/services/crud-customers/endpoints/updateCustomer.handler
  environment:
    SNS_TOPIC_CUSTOMER_UPDATE:
      Fn::ImportValue: ${self:custom.stage}:${self:service}-infra:customersUpdateEventsTopicArn
  iamRoleStatements:
    - Effect: "Allow"
      Resource:
        Fn::ImportValue: ${self:custom.stage}:${self:service}-infra:customersUpdateEventsTopicArn
      Action:
        - sns:Publish
  events:
    - http:
        path: /customers/{id}
        method: put
        cors: true

#function para deletar customers
deleteCustomer:
  warmup: true
  handler: src/services/crud-customers/endpoints/deleteCustomer.handler
  events:
    - http:
        path: /customers/{id}
        method: delete
        cors: true
